{
  "info": {
    "name": "Event Booking App - Tickets API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_postman_id": "7bbf1b2a-1a4f-4d0a-bf5e-6b3f9f7a9a00"
  },
  "variable": [
    { "key": "base_url", "value": "http://localhost:8081" },
    { "key": "keycloak_url", "value": "http://localhost:9090" },
    { "key": "realm", "value": "event-ticket-platform" },
    { "key": "client_id", "value": "" },
    { "key": "username", "value": "" },
    { "key": "password", "value": "" },
    { "key": "access_token", "value": "" },
    { "key": "event_id", "value": "" },
    { "key": "ticket_type_id", "value": "" },
    { "key": "ticket_id", "value": "" },
    { "key": "discount_id", "value": "" },
    { "key": "user_id", "value": "" },
    { "key": "invite_code_id", "value": "" }
  ],
  "item": [
    {
      "name": "Auth",
      "item": [
        {
          "name": "Get Access Token",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/x-www-form-urlencoded" }
            ],
            "url": {
              "raw": "{{keycloak_url}}/realms/{{realm}}/protocol/openid-connect/token",
              "host": ["{{keycloak_url}}"],
              "path": ["realms", "{{realm}}", "protocol", "openid-connect", "token"]
            },
            "body": {
              "mode": "urlencoded",
              "urlencoded": [
                { "key": "grant_type", "value": "password" },
                { "key": "client_id", "value": "{{client_id}}" },
                { "key": "username", "value": "{{username}}" },
                { "key": "password", "value": "{{password}}" },
                { "key": "scope", "value": "openid profile email" }
              ]
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "  const data = pm.response.json();",
                  "  pm.collectionVariables.set('access_token', data.access_token);",
                  "  pm.collectionVariables.set('token_expiry', Date.now() + (data.expires_in * 1000));",
                  "  pm.test('Access token obtained', function(){ pm.expect(data.access_token).to.exist; });",
                  "} else { pm.test('Failed to get token', function(){ pm.expect.fail('Token request failed'); }); }"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "Events (Organizer)",
      "item": [
        {
          "name": "Create Event",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/events", "host": ["{{base_url}}"], "path": ["api","v1","events"] },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Tech Conference 2025\",\n  \"start\": \"2025-12-15T09:00:00\",\n  \"end\": \"2025-12-15T18:00:00\",\n  \"venue\": \"Convention Center\",\n  \"salesStart\": \"2025-11-01T00:00:00\",\n  \"salesEnd\": \"2025-12-14T23:59:59\",\n  \"status\": \"PUBLISHED\",\n  \"ticketTypes\": [ { \"name\": \"Early Bird\", \"price\": 199.99, \"description\": \"Discounted\", \"totalAvailable\": 100 } ]\n}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const res = pm.response.json();",
                  "if (res && res.id) { pm.collectionVariables.set('event_id', res.id); }",
                  "if (res && res.ticketTypes && res.ticketTypes.length) { pm.collectionVariables.set('ticket_type_id', res.ticketTypes[0].id); }",
                  "pm.test('Created', function(){ pm.expect(pm.response.code).to.eql(201); });"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Update Event",
          "request": {
            "method": "PUT",
            "header": [ { "key": "Content-Type", "value": "application/json" }, { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}"] },
            "body": { "mode": "raw", "raw": "{\n  \"id\": \"{{event_id}}\",\n  \"name\": \"Tech Conference 2025 - Updated\",\n  \"start\": \"2025-12-15T10:00:00\",\n  \"end\": \"2025-12-15T19:00:00\",\n  \"venue\": \"Main Hall\",\n  \"salesStart\": \"2025-11-01T00:00:00\",\n  \"salesEnd\": \"2025-12-14T23:59:59\",\n  \"status\": \"PUBLISHED\",\n  \"ticketTypes\": [ { \"id\": \"{{ticket_type_id}}\", \"name\": \"Regular\", \"price\": 299.99, \"description\": \"Standard\", \"totalAvailable\": 400 } ]\n}" }
          }
        },
        {
          "name": "List Events",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events?page=0&size=20&sort=start,desc", "host": ["{{base_url}}"], "path": ["api","v1","events"], "query": [ {"key":"page","value":"0"},{"key":"size","value":"20"},{"key":"sort","value":"start,desc"} ] }
          }
        },
        {
          "name": "Get Event",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}"] }
          }
        },
        {
          "name": "Delete Event",
          "request": {
            "method": "DELETE",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}"] }
          }
        },
        {
          "name": "Get Sales Dashboard",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/sales-dashboard", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","sales-dashboard"] }
          }
        },
        {
          "name": "Get Attendees Report",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/attendees-report", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","attendees-report"] }
          }
        },
        {
          "name": "Export Sales Report (Excel)",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/sales-report.xlsx", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","sales-report.xlsx"] }
          }
        }
      ]
    },
    {
      "name": "Published Events",
      "item": [
        {
          "name": "List Published Events",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/published-events?q=tech&page=0&size=20&sort=start,asc", "host": ["{{base_url}}"], "path": ["api","v1","published-events"], "query": [ {"key":"q","value":"tech"},{"key":"page","value":"0"},{"key":"size","value":"20"},{"key":"sort","value":"start,asc"} ] }
          }
        },
        {
          "name": "Get Published Event",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/published-events/{{event_id}}", "host": ["{{base_url}}"], "path": ["api","v1","published-events","{{event_id}}"] }
          }
        }
      ]
    },
    {
      "name": "Ticket Types (Organizer)",
      "item": [
        {
          "name": "Create Ticket Type",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/ticket-types", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","ticket-types"] },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"VIP Pass\",\n  \"price\": 499.99,\n  \"description\": \"Premium access\",\n  \"totalAvailable\": 50\n}"
            }
          }
        },
        {
          "name": "List Ticket Types",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/ticket-types", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","ticket-types"] }
          }
        },
        {
          "name": "Get Ticket Type",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/ticket-types/{{ticket_type_id}}", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","ticket-types","{{ticket_type_id}}"] }
          }
        },
        {
          "name": "Update Ticket Type",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/ticket-types/{{ticket_type_id}}", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","ticket-types","{{ticket_type_id}}"] },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"VIP Pass Updated\",\n  \"price\": 549.99,\n  \"description\": \"Updated premium access\",\n  \"totalAvailable\": 75\n}"
            }
          }
        },
        {
          "name": "Delete Ticket Type",
          "request": {
            "method": "DELETE",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/ticket-types/{{ticket_type_id}}", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","ticket-types","{{ticket_type_id}}"] }
          }
        }
      ]
    },
    {
      "name": "Discounts (Organizer)",
      "item": [
        {
          "name": "Create Discount",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/ticket-types/{{ticket_type_id}}/discounts", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","ticket-types","{{ticket_type_id}}","discounts"] },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"discountType\": \"PERCENTAGE\",\n  \"value\": 20.0,\n  \"validFrom\": \"2025-11-01T00:00:00\",\n  \"validTo\": \"2025-11-30T23:59:59\",\n  \"description\": \"Early Bird Special\"\n}"
            }
          }
        },
        {
          "name": "Update Discount",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/ticket-types/{{ticket_type_id}}/discounts/{{discount_id}}", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","ticket-types","{{ticket_type_id}}","discounts","{{discount_id}}"] },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"discountType\": \"PERCENTAGE\",\n  \"value\": 25.0,\n  \"validFrom\": \"2025-11-01T00:00:00\",\n  \"validTo\": \"2025-11-30T23:59:59\",\n  \"description\": \"Early Bird Special Updated\"\n}"
            }
          }
        },
        {
          "name": "Delete Discount",
          "request": {
            "method": "DELETE",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/ticket-types/{{ticket_type_id}}/discounts/{{discount_id}}", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","ticket-types","{{ticket_type_id}}","discounts","{{discount_id}}"] }
          }
        },
        {
          "name": "Get Discount",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/ticket-types/{{ticket_type_id}}/discounts/{{discount_id}}", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","ticket-types","{{ticket_type_id}}","discounts","{{discount_id}}"] }
          }
        },
        {
          "name": "List Discounts",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/ticket-types/{{ticket_type_id}}/discounts", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","ticket-types","{{ticket_type_id}}","discounts"] }
          }
        }
      ]
    },
    {
      "name": "Tickets",
      "item": [
        {
          "name": "Purchase Ticket",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/ticket-types/{{ticket_type_id}}/tickets", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","ticket-types","{{ticket_type_id}}","tickets"] },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"quantity\": 1\n}"
            }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Tickets purchased', function(){ pm.expect(pm.response.code).to.eql(201); });",
                  "const tickets = pm.response.json();",
                  "if (tickets && tickets.length) { pm.collectionVariables.set('ticket_id', tickets[0].id); }"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "List My Tickets",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/tickets?page=0&size=20&sort=id,desc", "host": ["{{base_url}}"], "path": ["api","v1","tickets"], "query": [ {"key":"page","value":"0"},{"key":"size","value":"20"},{"key":"sort","value":"id,desc"} ] }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const page = pm.response.json();",
                  "if (page && page.content && page.content.length) { pm.collectionVariables.set('ticket_id', page.content[0].id); }",
                  "pm.test('OK', function(){ pm.expect(pm.response.code).to.eql(200); });"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Get Ticket",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/tickets/{{ticket_id}}", "host": ["{{base_url}}"], "path": ["api","v1","tickets","{{ticket_id}}"] }
          }
        },
        {
          "name": "Get Ticket QR Code (PNG)",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/tickets/{{ticket_id}}/qr-codes", "host": ["{{base_url}}"], "path": ["api","v1","tickets","{{ticket_id}}","qr-codes"] }
          }
        },
        {
          "name": "View QR Code (Inline)",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/tickets/{{ticket_id}}/qr-codes/view", "host": ["{{base_url}}"], "path": ["api","v1","tickets","{{ticket_id}}","qr-codes","view"] }
          }
        },
        {
          "name": "Download QR Code (PNG)",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/tickets/{{ticket_id}}/qr-codes/png", "host": ["{{base_url}}"], "path": ["api","v1","tickets","{{ticket_id}}","qr-codes","png"] }
          }
        },
        {
          "name": "Download QR Code (PDF)",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/tickets/{{ticket_id}}/qr-codes/pdf", "host": ["{{base_url}}"], "path": ["api","v1","tickets","{{ticket_id}}","qr-codes","pdf"] }
          }
        }
      ]
    },
    {
      "name": "Ticket Validations",
      "item": [
        {
          "name": "Validate Ticket (MANUAL)",
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "url": { "raw": "{{base_url}}/api/v1/ticket-validations", "host": ["{{base_url}}"], "path": ["api","v1","ticket-validations"] },
            "body": { "mode": "raw", "raw": "{\n  \"id\": \"{{ticket_id}}\",\n  \"method\": \"MANUAL\"\n}" }
          }
        },
        {
          "name": "Validate Ticket (QR_CODE)",
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "url": { "raw": "{{base_url}}/api/v1/ticket-validations", "host": ["{{base_url}}"], "path": ["api","v1","ticket-validations"] },
            "body": { "mode": "raw", "raw": "{\n  \"id\": \"{{ticket_id}}\",\n  \"method\": \"QR_CODE\"\n}" }
          }
        },
        {
          "name": "List Validations for Event",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/ticket-validations/events/{{event_id}}?page=0&size=20", "host": ["{{base_url}}"], "path": ["api","v1","ticket-validations","events","{{event_id}}"], "query": [ {"key":"page","value":"0"},{"key":"size","value":"20"} ] }
          }
        },
        {
          "name": "Get Validations by Ticket",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/ticket-validations/tickets/{{ticket_id}}", "host": ["{{base_url}}"], "path": ["api","v1","ticket-validations","tickets","{{ticket_id}}"] }
          }
        }
      ]
    },
    {
      "name": "Admin Governance",
      "item": [
        {
          "name": "Get Available Roles",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/roles", "host": ["{{base_url}}"], "path": ["api","v1","admin","roles"] }
          }
        },
        {
          "name": "Assign Role to User",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/admin/users/{{user_id}}/roles", "host": ["{{base_url}}"], "path": ["api","v1","admin","users","{{user_id}}","roles"] },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"roleName\": \"STAFF\"\n}"
            }
          }
        },
        {
          "name": "Get User Roles",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/users/{{user_id}}/roles", "host": ["{{base_url}}"], "path": ["api","v1","admin","users","{{user_id}}","roles"] }
          }
        },
        {
          "name": "Revoke Role from User",
          "request": {
            "method": "DELETE",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/users/{{user_id}}/roles/STAFF", "host": ["{{base_url}}"], "path": ["api","v1","admin","users","{{user_id}}","roles","STAFF"] }
          }
        }
      ]
    },
    {
      "name": "Approval Management (Admin)",
      "item": [
        {
          "name": "List All Users with Approval Status",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/approvals?page=0&size=20", "host": ["{{base_url}}"], "path": ["api","v1","admin","approvals"], "query": [ {"key":"page","value":"0"},{"key":"size","value":"20"} ] }
          }
        },
        {
          "name": "List Pending Approvals",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/approvals/pending?page=0&size=20", "host": ["{{base_url}}"], "path": ["api","v1","admin","approvals","pending"], "query": [ {"key":"page","value":"0"},{"key":"size","value":"20"} ] }
          }
        },
        {
          "name": "Approve User",
          "request": {
            "method": "POST",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/approvals/{{user_id}}/approve", "host": ["{{base_url}}"], "path": ["api","v1","admin","approvals","{{user_id}}","approve"] }
          }
        },
        {
          "name": "Reject User",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/admin/approvals/{{user_id}}/reject", "host": ["{{base_url}}"], "path": ["api","v1","admin","approvals","{{user_id}}","reject"] },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"reason\": \"Account violates terms of service\"\n}"
            }
          }
        }
      ]
    },
    {
      "name": "Event Staff Management (Organizer)",
      "item": [
        {
          "name": "Assign Staff to Event",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/staff", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","staff"] },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"userId\": \"{{user_id}}\"\n}"
            }
          }
        },
        {
          "name": "List Event Staff",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/staff", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","staff"] }
          }
        },
        {
          "name": "Remove Staff from Event",
          "request": {
            "method": "DELETE",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/staff/{{user_id}}", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","staff","{{user_id}}"] }
          }
        }
      ]
    },
    {
      "name": "Invite Codes",
      "item": [
        {
          "name": "Generate Invite Code",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/invites", "host": ["{{base_url}}"], "path": ["api","v1","invites"] },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"roleName\": \"STAFF\",\n  \"eventId\": \"{{event_id}}\",\n  \"expirationHours\": 48\n}"
            }
          }
        },
        {
          "name": "Redeem Invite Code",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{access_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/invites/redeem", "host": ["{{base_url}}"], "path": ["api","v1","invites","redeem"] },
            "body": {
              "mode": "raw",
              "raw": "{\n  \"code\": \"ABCD-EFGH-IJKL-MNOP\"\n}"
            }
          }
        },
        {
          "name": "List Invite Codes",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/invites?page=0&size=20&sort=createdAt,desc", "host": ["{{base_url}}"], "path": ["api","v1","invites"], "query": [ {"key":"page","value":"0"},{"key":"size","value":"20"},{"key":"sort","value":"createdAt,desc"} ] }
          }
        },
        {
          "name": "List Event Invite Codes",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/invites/events/{{event_id}}?page=0&size=20", "host": ["{{base_url}}"], "path": ["api","v1","invites","events","{{event_id}}"], "query": [ {"key":"page","value":"0"},{"key":"size","value":"20"} ] }
          }
        },
        {
          "name": "Revoke Invite Code",
          "request": {
            "method": "DELETE",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/invites/{{invite_code_id}}?reason=No%20longer%20needed", "host": ["{{base_url}}"], "path": ["api","v1","invites","{{invite_code_id}}"], "query": [ {"key":"reason","value":"No%20longer%20needed"} ] }
          }
        }
      ]
    },
    {
      "name": "Audit Logs",
      "item": [
        {
          "name": "View All Audit Logs (Admin)",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/audit?page=0&size=20&sort=createdAt,desc", "host": ["{{base_url}}"], "path": ["api","v1","audit"], "query": [ {"key":"page","value":"0"},{"key":"size","value":"20"},{"key":"sort","value":"createdAt,desc"} ] }
          }
        },
        {
          "name": "View Event Audit Logs (Organizer)",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/audit/events/{{event_id}}?page=0&size=20", "host": ["{{base_url}}"], "path": ["api","v1","audit","events","{{event_id}}"], "query": [ {"key":"page","value":"0"},{"key":"size","value":"20"} ] }
          }
        },
        {
          "name": "View My Audit Trail",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{access_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/audit/me?page=0&size=20", "host": ["{{base_url}}"], "path": ["api","v1","audit","me"], "query": [ {"key":"page","value":"0"},{"key":"size","value":"20"} ] }
          }
        }
      ]
    },
    {
      "name": "NEGATIVE TESTS",
      "item": [
        {
          "name": "Approval Gate Violation - PENDING User",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{pending_user_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/published-events?page=0&size=20", "host": ["{{base_url}}"], "path": ["api","v1","published-events"], "query": [ {"key":"page","value":"0"},{"key":"size","value":"20"} ] }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Approval gate blocks PENDING user', function(){ pm.expect(pm.response.code).to.eql(403); });",
                  "const jsonData = pm.response.json();",
                  "pm.expect(jsonData.error).to.eql('APPROVAL_PENDING');"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Role Mismatch - ATTENDEE on ADMIN Endpoint",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{attendee_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/admin/roles", "host": ["{{base_url}}"], "path": ["api","v1","admin","roles"] }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Role mismatch blocks ATTENDEE from ADMIN endpoint', function(){ pm.expect(pm.response.code).to.eql(403); });"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Ownership Violation - ORGANIZER on Another's Event",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{organizer_a_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{organizer_b_event_id}}", "host": ["{{base_url}}"], "path": ["api","v1","events","{{organizer_b_event_id}}"] }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Ownership violation blocks ORGANIZER from another organizer\\'s event', function(){ pm.expect(pm.response.code).to.eql(403); });"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Business Rule - Purchase from DRAFT Event",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{attendee_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{draft_event_id}}/ticket-types/{{ticket_type_id}}/tickets", "host": ["{{base_url}}"], "path": ["api","v1","events","{{draft_event_id}}","ticket-types","{{ticket_type_id}}","tickets"] },
            "body": { "mode": "raw", "raw": "{\n  \"quantity\": 1\n}" }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Business rule blocks purchase from DRAFT event', function(){ pm.expect(pm.response.code).to.eql(400); });"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Business Rule - Ticket Already Validated",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{staff_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/ticket-validations", "host": ["{{base_url}}"], "path": ["api","v1","ticket-validations"] },
            "body": { "mode": "raw", "raw": "{\n  \"id\": \"{{validated_ticket_id}}\",\n  \"method\": \"MANUAL\"\n}" }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Business rule blocks re-validation of already validated ticket', function(){ pm.expect(pm.response.code).to.eql(409); });"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Business Rule - Staff Not Assigned to Event",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{unassigned_staff_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/ticket-validations", "host": ["{{base_url}}"], "path": ["api","v1","ticket-validations"] },
            "body": { "mode": "raw", "raw": "{\n  \"id\": \"{{ticket_id}}\",\n  \"method\": \"MANUAL\"\n}" }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Business rule blocks STAFF validation for unassigned event', function(){ pm.expect(pm.response.code).to.eql(403); });"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    },
    {
      "name": "SECURITY TESTS",
      "item": [
        {
          "name": "Unauthorized Access - No Token",
          "request": {
            "method": "GET",
            "header": [],
            "url": { "raw": "{{base_url}}/api/v1/published-events?page=0&size=20", "host": ["{{base_url}}"], "path": ["api","v1","published-events"], "query": [ {"key":"page","value":"0"},{"key":"size","value":"20"} ] }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('No token blocks access', function(){ pm.expect(pm.response.code).to.eql(401); });"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Expired Token",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{expired_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/published-events?page=0&size=20", "host": ["{{base_url}}"], "path": ["api","v1","published-events"], "query": [ {"key":"page","value":"0"},{"key":"size","value":"20"} ] }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('Expired token blocks access', function(){ pm.expect(pm.response.code).to.eql(401); });"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Cross-Role Access Attempt - ATTENDEE to ORGANIZER Endpoint",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{attendee_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events?page=0&size=20", "host": ["{{base_url}}"], "path": ["api","v1","events"], "query": [ {"key":"page","value":"0"},{"key":"size","value":"20"} ] }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('ATTENDEE blocked from ORGANIZER endpoint', function(){ pm.expect(pm.response.code).to.eql(403); });"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "QR Code Access Control - STAFF Cannot Export QR",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{staff_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/tickets/{{ticket_id}}/qr-codes/view", "host": ["{{base_url}}"], "path": ["api","v1","tickets","{{ticket_id}}","qr-codes","view"] }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('STAFF blocked from QR export', function(){ pm.expect(pm.response.code).to.eql(403); });"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Sales Report Access Control - ATTENDEE Cannot Export",
          "request": {
            "method": "GET",
            "header": [ { "key": "Authorization", "value": "Bearer {{attendee_token}}" } ],
            "url": { "raw": "{{base_url}}/api/v1/events/{{event_id}}/sales-report.xlsx", "host": ["{{base_url}}"], "path": ["api","v1","events","{{event_id}}","sales-report.xlsx"] }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('ATTENDEE blocked from sales report export', function(){ pm.expect(pm.response.code).to.eql(403); });"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Approval Gate Bypass Verification - PENDING User Can Register",
          "request": {
            "method": "POST",
            "header": [ { "key": "Content-Type", "value": "application/json" } ],
            "url": { "raw": "{{base_url}}/api/v1/auth/register", "host": ["{{base_url}}"], "path": ["api","v1","auth","register"] },
            "body": { "mode": "raw", "raw": "{\n  \"email\": \"pending@test.com\",\n  \"password\": \"Password123\",\n  \"name\": \"Pending User\"\n}" }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('PENDING user can register (bypass works)', function(){ pm.expect(pm.response.code).to.eql(201); });"
                ],
                "type": "text/javascript"
              }
            }
          ]
        },
        {
          "name": "Approval Gate Bypass Verification - PENDING User Can Redeem Invite",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{pending_user_token}}" }
            ],
            "url": { "raw": "{{base_url}}/api/v1/invites/redeem", "host": ["{{base_url}}"], "path": ["api","v1","invites","redeem"] },
            "body": { "mode": "raw", "raw": "{\n  \"code\": \"ABCD-EFGH-IJKL-MNOP\"\n}" }
          },
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test('PENDING user can redeem invite (bypass works)', function(){ pm.expect(pm.response.code).to.eql(200); });"
                ],
                "type": "text/javascript"
              }
            }
          ]
        }
      ]
    }
  ]
}
